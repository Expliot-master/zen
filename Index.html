<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zen - AI Coding Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/night-owl.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e2e8f0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
            background: rgba(15, 23, 42, 0.9);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(24, 223, 245, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(24, 223, 245, 0.1);
            position: relative;
        }
        
        header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #f8fafc;
            padding: 28px 35px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid rgba(24, 223, 245, 0.2);
        }
        
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(24, 223, 245, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            transform: rotate(30deg);
            opacity: 0.3;
            animation: float 20s infinite linear;
        }
        
        @keyframes float {
            0% { transform: rotate(0deg) translateX(0px); }
            100% { transform: rotate(360deg) translateX(0px); }
        }
        
        h1 {
            font-size: 3.2rem;
            font-weight: 700;
            letter-spacing: 3px;
            margin-bottom: 12px;
            position: relative;
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(24, 223, 245, 0.3);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.8;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .creator-tag {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 0.8rem;
            color: rgba(24, 223, 245, 0.7);
            background: rgba(15, 23, 42, 0.6);
            padding: 5px 10px;
            border-radius: 20px;
            border: 1px solid rgba(24, 223, 245, 0.2);
        }
        
        .tabs-container {
            background: rgba(15, 23, 42, 0.9);
            border-bottom: 1px solid rgba(24, 223, 245, 0.2);
            padding: 0 20px;
            display: flex;
            align-items: center;
            overflow-x: auto;
        }
        
        .tabs {
            display: flex;
            gap: 5px;
            flex: 1;
        }
        
        .tab {
            padding: 12px 20px;
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(24, 223, 245, 0.2);
            border-bottom: none;
            border-radius: 12px 12px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
            color: #94a3b8;
        }
        
        .tab.active {
            background: rgba(15, 23, 42, 0.9);
            color: #e2e8f0;
            border-color: rgba(24, 223, 245, 0.5);
            box-shadow: 0 -2px 10px rgba(24, 223, 245, 0.1);
        }
        
        .tab:hover:not(.active) {
            background: rgba(30, 41, 59, 0.9);
            color: #cbd5e1;
        }
        
        .tab-close {
            margin-left: 8px;
            font-size: 0.8rem;
            opacity: 0.7;
            transition: all 0.2s;
        }
        
        .tab-close:hover {
            opacity: 1;
            color: #18DFF5;
        }
        
        .add-tab {
            padding: 12px 16px;
            background: rgba(24, 223, 245, 0.1);
            border: 1px solid rgba(24, 223, 245, 0.3);
            border-radius: 12px 12px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            color: #18DFF5;
            margin-left: 10px;
        }
        
        .add-tab:hover {
            background: rgba(24, 223, 245, 0.2);
            transform: scale(1.05);
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chat-messages {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 24px;
            background: 
                radial-gradient(circle at 20% 80%, rgba(24, 223, 245, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(24, 223, 245, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(24, 223, 245, 0.03) 0%, transparent 50%);
        }
        
        /* Custom scrollbar */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 10px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            border-radius: 10px;
        }
        
        .message {
            max-width: 80%;
            padding: 20px 25px;
            border-radius: 20px;
            line-height: 1.6;
            position: relative;
            animation: fadeIn 0.4s ease-out;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            align-self: flex-end;
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            color: white;
            border-bottom-right-radius: 8px;
            border: 1px solid rgba(24, 223, 245, 0.3);
        }
        
        .bot-message {
            align-self: flex-start;
            background: rgba(30, 41, 59, 0.7);
            color: #e2e8f0;
            border: 1px solid rgba(24, 223, 245, 0.2);
            border-bottom-left-radius: 8px;
        }
        
        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 10px;
            text-align: right;
        }
        
        .input-area {
            padding: 25px;
            background: rgba(15, 23, 42, 0.9);
            border-top: 1px solid rgba(24, 223, 245, 0.2);
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .message-input {
            flex: 1;
            padding: 18px 25px;
            border: 1px solid rgba(24, 223, 245, 0.3);
            border-radius: 50px;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s;
            background: rgba(30, 41, 59, 0.7);
            color: #e2e8f0;
            box-shadow: 0 0 0 0 rgba(24, 223, 245, 0);
        }
        
        .message-input:focus {
            border-color: #18DFF5;
            box-shadow: 0 0 0 3px rgba(24, 223, 245, 0.2);
            background: rgba(30, 41, 59, 0.9);
        }
        
        .message-input::placeholder {
            color: #94a3b8;
        }
        
        .send-button {
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 15px rgba(24, 223, 245, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .send-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }
        
        .send-button:hover::before {
            left: 100%;
        }
        
        .send-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(24, 223, 245, 0.5);
        }
        
        .send-button:active {
            transform: translateY(0);
        }
        
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background: rgba(30, 41, 59, 0.7);
            padding: 20px 25px;
            border-radius: 20px;
            border-bottom-left-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid rgba(24, 223, 245, 0.2);
        }
        
        .typing-dots {
            display: flex;
            gap: 6px;
        }
        
        .typing-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #18DFF5;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typingAnimation {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        .welcome-message {
            text-align: center;
            padding: 40px 30px;
            color: #94a3b8;
        }
        
        .welcome-message h3 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #e2e8f0;
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .suggestion {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(24, 223, 245, 0.3);
            border-radius: 50px;
            padding: 12px 24px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            color: #e2e8f0;
        }
        
        .suggestion:hover {
            background: rgba(24, 223, 245, 0.1);
            border-color: #18DFF5;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(24, 223, 245, 0.2);
        }
        
        footer {
            margin-top: 25px;
            text-align: center;
            font-size: 0.9rem;
            color: #64748b;
        }
        
        pre {
            border-radius: 12px;
            padding: 20px;
            overflow-x: auto;
            margin: 15px 0;
            background: #0f172a;
            border: 1px solid rgba(24, 223, 245, 0.2);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.85rem;
            color: #94a3b8;
        }
        
        .copy-button {
            background: rgba(24, 223, 245, 0.2);
            color: #18DFF5;
            border: 1px solid rgba(24, 223, 245, 0.3);
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .copy-button:hover {
            background: rgba(24, 223, 245, 0.3);
            border-color: #18DFF5;
        }
        
        .glow {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle at center, rgba(24, 223, 245, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: -1;
        }
        
        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .shape {
            position: absolute;
            border-radius: 50%;
            background: rgba(24, 223, 245, 0.05);
            animation: floatShape 15s infinite ease-in-out;
        }
        
        .shape:nth-child(1) {
            width: 100px;
            height: 100px;
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .shape:nth-child(2) {
            width: 150px;
            height: 150px;
            top: 60%;
            left: 80%;
            animation-delay: -5s;
        }
        
        .shape:nth-child(3) {
            width: 80px;
            height: 80px;
            top: 80%;
            left: 20%;
            animation-delay: -10s;
        }
        
        @keyframes floatShape {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: rgba(15, 23, 42, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(24, 223, 245, 0.3);
        }
        
        .modal h2 {
            margin-bottom: 20px;
            color: #e2e8f0;
            font-size: 1.8rem;
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .modal p {
            margin-bottom: 30px;
            color: #94a3b8;
            line-height: 1.6;
        }
        
        .modal-input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid rgba(24, 223, 245, 0.3);
            border-radius: 50px;
            font-size: 1rem;
            outline: none;
            background: rgba(30, 41, 59, 0.7);
            color: #e2e8f0;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .modal-input:focus {
            border-color: #18DFF5;
            box-shadow: 0 0 0 3px rgba(24, 223, 245, 0.2);
        }
        
        .modal-button {
            background: linear-gradient(135deg, #18DFF5 0%, #0ea5e9 100%);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 40px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 15px rgba(24, 223, 245, 0.4);
        }
        
        .modal-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(24, 223, 245, 0.5);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-card {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(24, 223, 245, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(24, 223, 245, 0.2);
            border-color: rgba(24, 223, 245, 0.5);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #18DFF5;
        }
        
        .feature-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #e2e8f0;
        }
        
        .feature-desc {
            font-size: 0.9rem;
            color: #94a3b8;
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .container {
                height: 95vh;
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .message {
                max-width: 90%;
            }
            
            .suggestions {
                flex-direction: column;
                align-items: center;
            }
            
            .suggestion {
                width: 100%;
                max-width: 300px;
                text-align: center;
            }
            
            .creator-tag {
                position: relative;
                top: 0;
                right: 0;
                margin-top: 10px;
                display: inline-block;
            }
            
            .tabs-container {
                padding: 0 10px;
            }
            
            .tab {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="glow"></div>
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>
    
    <div class="modal" id="nameModal">
        <div class="modal-content">
            <h2>Welcome to Zen</h2>
            <p>Please enter your name to personalize your experience</p>
            <input type="text" class="modal-input" id="userNameInput" placeholder="Your name">
            <button class="modal-button" onclick="saveUserName()">Get Started</button>
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1>ZEN</h1>
            <p class="tagline">AI-Powered Coding & Conversations</p>
            <div class="creator-tag">Created by Havish</div>
        </header>
        
        <div class="tabs-container">
            <div class="tabs" id="tabs"></div>
            <div class="add-tab" onclick="addNewTab()">
                <i class="fas fa-plus"></i>
            </div>
        </div>
        
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <h3>Welcome to Zen</h3>
                    <p>Your AI assistant for coding, debugging, and creative problem-solving.</p>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-code"></i>
                            </div>
                            <div class="feature-title">Code Generation</div>
                            <div class="feature-desc">Generate code snippets in multiple languages with explanations</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-bug"></i>
                            </div>
                            <div class="feature-title">Debugging Help</div>
                            <div class="feature-desc">Identify and fix issues in your code with detailed explanations</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="feature-title">Creative Solutions</div>
                            <div class="feature-desc">Get innovative approaches to complex programming problems</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="feature-title">Learning Resources</div>
                            <div class="feature-desc">Learn new concepts with detailed explanations and examples</div>
                        </div>
                    </div>
                    
                    <div class="suggestions">
                        <div class="suggestion" onclick="insertSuggestion('Create a responsive navbar with HTML/CSS')">Navbar HTML/CSS</div>
                        <div class="suggestion" onclick="insertSuggestion('Python function to calculate factorial')">Python Factorial</div>
                        <div class="suggestion" onclick="insertSuggestion('JavaScript fetch API example')">JS Fetch API</div>
                        <div class="suggestion" onclick="insertSuggestion('Who created this assistant?')">Who made Zen?</div>
                    </div>
                </div>
            </div>
            
            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
            
            <div class="input-area">
                <input type="text" class="message-input" id="messageInput" placeholder="Ask me to code something or explain a concept..." onkeypress="handleKeyPress(event)">
                <button class="send-button" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Zen AI &copy; 2023 | Created by Havish Coco</p>
    </footer>

    <script>
        const apiKey = "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";
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const typingIndicator = document.getElementById('typingIndicator');
        const nameModal = document.getElementById('nameModal');
        const tabsContainer = document.getElementById('tabs');
        
        let currentTabId = 1;
        let tabs = {};
        let userName = localStorage.getItem('zenUserName');
        
        // Configure marked to use highlight.js for code blocks
        marked.setOptions({
            highlight: function(code, lang) {
                if (lang && hljs.getLanguage(lang)) {
                    return hljs.highlight(code, { language: lang }).value;
                }
                return hljs.highlightAuto(code).value;
            },
            langPrefix: 'hljs language-'
        });
        
        // Initialize the app
        function initApp() {
            // Check if user name exists
            if (!userName) {
                nameModal.style.display = 'flex';
            } else {
                // Add initial bot message with user's name
                setTimeout(() => {
                    addMessage(`Hello ${userName}! I'm Zen, your AI coding assistant created by **Havish**. I can help you with programming questions, write code examples, debug issues, explain concepts, and more. What would you like to create or learn today?`);
                }, 1000);
            }
            
            // Load tabs from localStorage
            loadTabs();
            
            // Focus on input field
            messageInput.focus();
        }
        
        // Save user name
        function saveUserName() {
            const nameInput = document.getElementById('userNameInput');
            userName = nameInput.value.trim();
            
            if (userName) {
                localStorage.setItem('zenUserName', userName);
                nameModal.style.display = 'none';
                
                // Add initial bot message with user's name
                setTimeout(() => {
                    addMessage(`Hello ${userName}! I'm Zen, your AI coding assistant created by **Havish**. I can help you with programming questions, write code examples, debug issues, explain concepts, and more. What would you like to create or learn today?`);
                }, 1000);
            } else {
                alert('Please enter your name');
            }
        }
        
        // Tab management functions
        function loadTabs() {
            const savedTabs = localStorage.getItem('zenTabs');
            if (savedTabs) {
                tabs = JSON.parse(savedTabs);
                renderTabs();
                
                // Load the first tab
                if (Object.keys(tabs).length > 0) {
                    const firstTabId = Object.keys(tabs)[0];
                    switchTab(parseInt(firstTabId));
                } else {
                    addNewTab();
                }
            } else {
                addNewTab();
            }
        }
        
        function saveTabs() {
            localStorage.setItem('zenTabs', JSON.stringify(tabs));
        }
        
        function addNewTab() {
            const tabId = currentTabId++;
            tabs[tabId] = {
                id: tabId,
                name: `Chat ${tabId}`,
                messages: []
            };
            
            saveTabs();
            renderTabs();
            switchTab(tabId);
        }
        
        function renameTab(tabId, newName) {
            if (tabs[tabId]) {
                tabs[tabId].name = newName || `Chat ${tabId}`;
                saveTabs();
                renderTabs();
            }
        }
        
        function closeTab(tabId, event) {
            event.stopPropagation();
            
            if (Object.keys(tabs).length <= 1) {
                alert("You need at least one tab open");
                return;
            }
            
            delete tabs[tabId];
            saveTabs();
            renderTabs();
            
            // Switch to the first available tab
            const firstTabId = Object.keys(tabs)[0];
            switchTab(parseInt(firstTabId));
        }
        
        function switchTab(tabId) {
            // Update active tab
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.tab[data-tab-id="${tabId}"]`).classList.add('active');
            
            // Clear chat messages
            chatMessages.innerHTML = '';
            
            // Load tab messages
            if (tabs[tabId].messages.length === 0) {
                // Show welcome message for empty tab
                const welcomeMessage = document.createElement('div');
                welcomeMessage.className = 'welcome-message';
                welcomeMessage.innerHTML = `
                    <h3>New Conversation</h3>
                    <p>Start a new conversation with Zen</p>
                    <div class="suggestions">
                        <div class="suggestion" onclick="insertSuggestion('Create a responsive navbar with HTML/CSS')">Navbar HTML/CSS</div>
                        <div class="suggestion" onclick="insertSuggestion('Python function to calculate factorial')">Python Factorial</div>
                        <div class="suggestion" onclick="insertSuggestion('JavaScript fetch API example')">JS Fetch API</div>
                        <div class="suggestion" onclick="insertSuggestion('Who created this assistant?')">Who made Zen?</div>
                    </div>
                `;
                chatMessages.appendChild(welcomeMessage);
            } else {
                // Add saved messages
                tabs[tabId].messages.forEach(msg => {
                    addMessage(msg.content, msg.isUser, false);
                });
            }
            
            // Update current tab
            currentTabId = tabId;
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        function renderTabs() {
            tabsContainer.innerHTML = '';
            
            Object.values(tabs).forEach(tab => {
                const tabElement = document.createElement('div');
                tabElement.className = 'tab';
                tabElement.setAttribute('data-tab-id', tab.id);
                tabElement.innerHTML = `
                    <span>${tab.name}</span>
                    <span class="tab-close" onclick="closeTab(${tab.id}, event)"><i class="fas fa-times"></i></span>
                `;
                
                tabElement.addEventListener('click', () => switchTab(tab.id));
                tabElement.addEventListener('dblclick', () => {
                    const newName = prompt('Enter new tab name:', tab.name);
                    renameTab(tab.id, newName);
                });
                
                tabsContainer.appendChild(tabElement);
            });
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
        
        function insertSuggestion(text) {
            messageInput.value = text;
            messageInput.focus();
        }
        
        function addMessage(content, isUser = false, saveToTab = true) {
            const messageDiv = document.createElement('div');
            messageDiv.className = isUser ? 'message user-message' : 'message bot-message';
            
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            if (isUser) {
                messageDiv.innerHTML = `
                    <div>${content}</div>
                    <div class="message-time">${time}</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div>${marked.parse(content)}</div>
                    <div class="message-time">${time}</div>
                `;
                
                // Add copy buttons to code blocks after the message is added
                setTimeout(() => {
                    addCopyButtons(messageDiv);
                }, 0);
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Save message to current tab
            if (saveToTab && tabs[currentTabId]) {
                tabs[currentTabId].messages.push({
                    content,
                    isUser,
                    timestamp: new Date().toISOString()
                });
                saveTabs();
            }
        }
        
        function addCopyButtons(container) {
            const codeBlocks = container.querySelectorAll('pre code');
            codeBlocks.forEach((codeBlock) => {
                const pre = codeBlock.parentElement;
                const header = document.createElement('div');
                header.className = 'code-header';
                
                const language = codeBlock.className.replace('hljs language-', '') || 'code';
                header.innerHTML = `
                    <span>${language}</span>
                    <button class="copy-button">Copy Code</button>
                `;
                
                pre.parentElement.insertBefore(header, pre);
                
                const copyButton = header.querySelector('.copy-button');
                copyButton.addEventListener('click', () => {
                    navigator.clipboard.writeText(codeBlock.textContent)
                        .then(() => {
                            copyButton.textContent = 'Copied!';
                            setTimeout(() => {
                                copyButton.textContent = 'Copy Code';
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Failed to copy: ', err);
                        });
                });
            });
        }
        
        function showTypingIndicator() {
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }
        
        function isCreatorQuestion(message) {
            const creatorKeywords = ['who made', 'who created', 'who built', 'who developed', 'creator', 'author', 'made by', 'created by'];
            const lowerMessage = message.toLowerCase();
            return creatorKeywords.some(keyword => lowerMessage.includes(keyword));
        }
        
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            // Clear input
            messageInput.value = '';
            
            // Add user message to chat
            addMessage(message, true);
            
            // Remove welcome message after first user message
            const welcomeMessage = document.querySelector('.welcome-message');
            if (welcomeMessage) {
                welcomeMessage.style.display = 'none';
            }
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Check if the user is asking about the creator
                if (isCreatorQuestion(message)) {
                    setTimeout(() => {
                        addMessage("Zen was created by **Havish**. I'm an AI assistant designed to help with coding, debugging, and creative problem-solving. Is there anything specific you'd like me to help you with today?");
                        hideTypingIndicator();
                    }, 1000);
                    return;
                }
                
                const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${apiKey}`,
                        "HTTP-Referer": window.location.origin || "https://zen-chat.example.com",
                        "X-Title": "Zen Chat"
                    },
                    body: JSON.stringify({
                        "model": "deepseek/deepseek-chat",
                        "messages": [
                            {
                                "role": "system",
                                "content": `You are Zen, an AI assistant with expertise in programming and software development. You provide clear, helpful code examples with explanations. When sharing code, use proper markdown code blocks with language specification. You can help with various programming languages, debugging, algorithms, web development, data science, and software engineering concepts. Keep responses concise but informative. If asked who created you, mention that Havish made you. The user's name is ${userName || 'there'}.`
                            },
                            {
                                "role": "user",
                                "content": message
                            }
                        ],
                        "max_tokens": 1500,
                        "temperature": 0.7
                    })
                });

                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error?.message || `HTTP error! status: ${response.status}`);
                }

                const content = data.choices?.[0]?.message?.content || "I'm sorry, I couldn't process that request. Please try again.";
                addMessage(content);
                
            } catch (err) {
                console.error('Error:', err);
                addMessage("I apologize, but I'm experiencing technical difficulties. Please try again in a moment.");
            } finally {
                hideTypingIndicator();
            }
        }
        
        // Initialize the app when the page loads
        window.onload = initApp;
    </script>
</body>
</html>
